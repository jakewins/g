
WHITESPACE = _{ " " | "\t" | "\r" | "\n" }


id = ${ ( ASCII_ALPHA | "_" | "-" ) + }

string = ${ "\"" ~ str_inner ~ "\"" }
str_inner = @{ char* }
char = {
    !("\"" | "\\") ~ ANY
    | "\\" ~ ("\"" | "\\" | "/" | "b" | "f" | "n" | "r" | "t")
}


expr = { string }

map_pair = { id ~ ":" ~ expr }
map = {
  "{" ~ "}" |
  "{" ~ map_pair ~ ("," ~ map_pair)* ~ "}"
}

node = { "(" ~ id? ~ (":" ~ id)? ~ map? ~ ")" }

rel = { "<"? ~ "-" ~ ( "[" ~ id? ~ (":" ~ id)? ~ map? ~ "]" )? ~ "-" ~ ">"? }

pattern = { node  ~ ( rel ~ node )* }

create_clause = { "CREATE" ~ pattern }

match_clause = { "MATCH" ~ pattern }
return_clause = { "RETURN" }

create_stmt = { create_clause }
match_stmt = { match_clause ~ return_clause? }

statement = { create_stmt | match_stmt }
query = { SOI ~ ( statement )* ~ EOI }